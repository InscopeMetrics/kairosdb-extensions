cache:
  directories:
  - "$HOME/.m2"
  - "$HOME/.jdk"
sudo: false
services:
- docker
addons:
  apt:
    packages:
    - rpm
env:
  global:
  - TARGE=install
  - secure: aANugu/1kR5uZl2nzd6Cm4hn6aA1eIPNrpUlQ7pI5aFZkkhPQ1g3qxR2e0z5sfKlpOV8iKbVEk+XrnnR2yJiJS3tDma6AHm/8CcvyB+2oEWZroumE/cva914uvwo15wfhNBQPPt6uAjBU8qPRpjrSmbTr/yiwSPQiwYmCYzYatpMLzCw/xjUQSnpu1Q85WJU0bcQe4yYO6xazrdpJgM2XUTvRybq4SEfEcpshm5KV/k3ux/xvwE6QBUYUgU+Cnm1p2jv2wgh3DrYJUVyokMKiwWoBvh21lmXm026T8+nHVvxpdUdXE69YJD250zLrvzLmv4C9sYYcQZGwzuBOWZa+tS4MPSu0kVcgFohC3Y8/fj0nTGmF3RKABGJwwAaq5ZsAGRL4SIBBr+zALdlRMy8dEQsVCc3O8TzQ/hmLVzQj/xmHimbP8KQgSXnFIfj4FyrLDZr/b8Yqo26UQ7n9wzjLcLZ2qPfkF+WHX7YuGSNTgtFDCMx55ukgGD/G57eqgR14052QQxAvAAWMkdJOxw0nJXEtJfRx8LBgVFH17a3FfWAB5x2/1Im4z9yMjTDIMtEP8ruqGwokcvMQXTUha+ye7xZCrLhzSI45dDRxmLcz4z0CLM9nrsJ1OqkY2JPNxhTUI74bJaTDLVGBP9nLsfbaxm8uPGZX93LmiozgXYZ1mE=
  - secure: CTP8oAraFI2rW5lmeHoZcZ9pS3dDaF9/pKn6CTakkpaAdR0PAeo/NHVGbNE/VSOAyl8VCa9NkNkCO2FESckWcliwJAriposs9MKLrfeWk2MfKSTQKNgDH65BXFaeHRB5WUMW7Vy0upkPpu4a+aB0BqZJfp+bTfKC0Eyhyhiz4oB9PUEwy7jIy+zGDAhU48DXLrj1oS2MOM72hwYhWcnrs5Mrdj987mfrZglq95qXN5qIee8A9JBiPoY/qu7rVYxJ4Nru1S5i57yxwvoz62nn9zrax6kincjQ3w53VL8D8C5bOUaOavFiwrAWC0m/B1MoMNLc+fpzmDZuExM5moJSsIyb3//gWJ0b9FetdK79ET2JGRJwcvtiJTIr/chGDSzdnCOimY4NTwR+FlUGYeJXEm4BhIAtGbttXw0xgknKnDpfAptGUv8+pydJJlN4ytaJ0gPOePGYVxIWbzZEocq6Tg7ZPMjW7CZwiYrF7KcvHSGHJ52Mc6xDf+uts72F/CXG/iAHWwIUsSFRYEWLOO14Jaf+RpdNsT4AHTTY8hAn25GFFO+P/EIkjb2zRZp9ld80kaDNKt7zoXn39ORnc7Ylx20SoIOQtAjaKz5+USx2OWVZ+Za9F7xm74iiR19ceOfL7kK//r+lSZmVAibH5HF9b5TTJoyTDEqHUjK9eAHc0N0=
  - secure: BdNEBuKIoqqj1ibPMmyT1VLcEvxhrGYlNKOhEa1KPQ6vdORbZICWwXM0HcD59g5W+KMv+5/UcNEqghabXgseH1aytgNN0d5XbFgzojN2C3ZftU2fOAguGrFjkDIcT8ASnmVzi+qz7E8LIDio/4gcooLwU5KvxWeyB++1pyFhW9PsGZ0hMGRq9nzxWYA29LxbhXIhawd7kI5MvbAKQGjY2zAJTPk1ymT4MbFMk8N7qV9bpIo2nE5g0tNmyllPVrG+rwo6uEV9TNnBO05ktHWxl4pctvgBtCLNCMwEE0Y1rcJ8/yFVQu+uVy5wmRCSVm7sJASc6lfG0Ajnonx5lXlmSEKS6PGBoO0JJgHx4HwMuZf9RwBqIU3qItFbURBOGxiO/xiyp8yENgLAuYMGxuYz58Ro5CeGJthrptfHOmprVPFwnJWXwVaWiZSj5zZDK0x/Fw+B6qUjmxEUvyEQ19vMbjPQT3L0tICROuFN/7c1L6Y9CoRsRhLj+nXYIbZCXaahf4yGuskOwRKFphRYN5uflkP7ilFIuhFTu755yX7Ges2dXRQhCUBKCXICIjlikoiWlWnpIJFqnA02AQOHoeCIhkj9NL9Ffixh1g4sNfVThbQFMtOOvhgP9K3cKlaTDD/blMZqJKwN+yz9gR8kB372vAM6Du3UHv8/GY+W3RTDUUY=
  - secure: l6vpzCyPz0SpMCgv9HHp1fWuhMOxm4R4qCxXRUP6ncyDblEq7w8dsy8RXPcqc4yD0vDeRjN/eTXfSrk/8KQhgyYwc0j5yXgfUKQ1AtUUmedUdDLpfaw62Qvc3mOrAeLvYcYSw+5puVa1BtcVrKgSDZY1nELxgSYBUBjUQMO5rRvKNDOB4+KaikhGRAMtBYyfnkkzSl7yg7RmH9TvX6/WH+NkgxN0fMFp6+bGe3sUrIuassimNS9vdBF1DRfJyjSC2YF/LhPtArFL23K0UzaXfcn1yKN+CYOOy2tQ+iKI977hw9XmueXar9RbMakGS6G6B4cKCiUVMtSmcN8z9OrWmcin2T4iUEFClPqPx2MbZwVU3nBDWBvFmzvLvxUrZIU+VelSPY7UDz7BqOzojXWL1fVieIXtw0Ufrsj45A+KkclKfmTae8GzHPy8P8oXjJ2SzPiI6i/a5IIHfeZOGvI6TXq7zSGrym1+gDYxhbxNVnkTbdFdtcR+56Zs5ncS3vmHclZIzWI5OZTe6Nn9poQntI2Ha5gVun412drJwm/eg32A7ml+8+5LBQOKODsoVIh91SLhnCMrosPdZOtSKemSFb0hbMVL1wdfW1UwHP8L/+WHCPmZnOgOWUeXJs1TqPQ4YhmP2/PfZQNt2dLiy826D1AC1Z0PlJmNZYui88y6aSg=
  - secure: DVNspzC4dM8vMbDItVFAo9BSAebYOhlJLN6MEIWbgqyXhzDLLqWFdtSW9lfi8QSwpb2cNmDyZp+BwU8OsrcHH5g+p4oAzqGwVm0F354SFnK/NUy9vEnSc2gWXldnyRZan00afX5ytR/GRKoVi+WCRQI08GhuUzyPdYoa2dOn2oOUYaaW9JR6eqeX8fnh30P+TteWqKyHdQPKMJLlBAJ5VBm8bFrnHlyxdRZob6YPRpWn+l62rdR/E3WtwoBhpBbaPeIWvD1vyxnXJ5sRUhCoXy9yhFbAGETQBZdfLzWBYcxZB91doCY2RiBzd/IzE92jG6SXToVH3K8PCPndQ6y+4GQWDAWV1/Ru7HgsEM2SzrHwNN5B1xbwC2TV7cqPd2ui18N4G+GBaBTLtBhYS8g0jioOUg+eVYpRC2fs56JT9oi/PlP8kR6ffJzLg1mSk8d0NdX9jDibF0ST8HzuqC9+KK0yZMjTy7sF3mfHED07KQQLeit0IUuQ1VbABfuwVXzlTWQlOSvVKg35dpLzzcPnWe0vpUj0lcfwGacq5RShDKo/Qt+5IsaDea8YPlkQBmOtVRh1NNpv3DHB0Ct1s6H19Y1iIqw0ZWzS3NXdiy6QE9T1XH5OTN0E/GgbxrMTKzYzAztNwm7G3yzrhW917BEfYMrrx9iQ7/ioXUFXrPxCwPI=
install: true
before_script:
- gpg --import ism.key
- if [ \( -n "${TRAVIS_TAG}" \) -a  "${TRAVIS_PULL_REQUEST}" = "false" ]; then export TARGET="deploy -P release --settings settings.xml"; fi;
script:
- ./jdk-wrapper.sh ./mvnw clean ${TARGET} -P rpm -U -B -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=warn
deploy:
  provider: releases
  api_key:
    secure: KndkW/8UAbM2W1IDoh0NYqNoZSz1629mZemq6p8CAVcyHXIiu+8ZfahpYtXQFmPWzlm18Wgd+XyrUkwsyjbHIPvLep4O+JGcQiul+EtF1xIztxJT3NInsj+Xe96T0lspgroy8tfPzTzKCtFWf5K7xY/vMcIrKfl3WRuDLJhNanqBPTgqCqQNe/fLCt5Hc6QQk0A9m3q2KBun33hNOYoZy1BJeJ7rB7apMUnKzA39lfPaU6Nx7o39XcywDhB/h/xFa/MzqKoA4bJ33q70YbhGvztznkIRfbaO39brpL13WoJwKPJ/xNDtN9pH9cVPZI1eopBtvCmIr4Wv4JislifdOsjVwmSR+svnKgcSu44PlaoAGpvmFpD/CqX18w6fs3BtDh9gNE+PS6VCpe2LuBtawkhJtQ9YFLi+GtPJBDC7OUsu1mMfiLCx6CFstCS/W+NVJWjN/IFkqhLuRhFDLnQjTVpIFfTJia5FOKqz6Y4iy2n1P0aMqEgi7LXxP/Z5Y8ezdJzHlwU80PbNrlHKI9z0FG2+k2RTuLax7Xo86+FEhllHODjTq3etUj32MzhvsbOKmmwM+ynNYtY0KsGuU5P5M8m3DPYcCnhlWPT8bL6fBF3HDcymi5P0oR31rcJc+Wgl2Jwmn/ARNHqNZ7ePAJSQ9x56SEMpJDWv6KMqsDScLFM=
  file:
  - target/rpm/kairosdb-extensions/RPMS/noarch/kairosdb-extensions*.rpm
  - target/kairosdb-extensions*-bin.tgz
  file_glob: true
  skip_cleanup: true
  on:
    repo: InscopeMetrics/kairosdb-extensions
    tags: true
